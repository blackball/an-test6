

We store the database passwords in svn/secure; check out separately with:
  svn co svn+ssh://astrometry.net/svn/secure/django-db secrets

Choose which settings to use:
  ln -s settings_test.py settings.py


Add some things to your PYTHONPATH:
  /usr/local/django-1.3/lib/python
  /usr/local/django-openid-auth-0.3/lib/python

Add some things to your PKG_CONFIG_PATH:
  /usr/local/wcslib-4.6.3/lib/pkgconfig

Add some things to your LD_LIBRARY_PATH:
  /usr/local/wcslib-4.6.3/lib


You will also need to build the Astrometry.net tools:
  (cd ..; make; make extra; make py)



Nova/Supernova setup:

user nova@oven

Nova:
- svn checkout is in ~/nova; url is like:
    svn+ssh://astrometry.net/svn/tags/nova/2011-06-08-2
- database is 'an-nova'
- ssh config entry is "an-nova"
- process_submissions.py is running in screen "nova"
- apache is /etc/apache2-nova
- logs are in /etc/apache2-nova/logs/

Supernova:
- svn checkout is in ~/supernova; url is like:
    svn+ssh://astrometry.net/svn/tags/supernova/2011-06-08-2
- database is 'an-supernova'
- ssh config entry is "an-supernova"
- process_submissions.py is running in screen "supernova"
- apache is /etc/apache2-supernova
- logs are in /etc/apache2-supernova/logs/


Run process_submissions.py by 'cd'ing into the appropriate net/ directory and:
  python -u process_submissions.py < /dev/null >> proc.log 2>&1 &



When you're ready to tag 'supernova', do:

svn copy svn+ssh://astrometry.net/svn/trunk/astrometry/src/astrometry \
    svn+ssh://astrometry.net/svn/tags/supernova/2011-06-08-2

(where you'll set the tag name appropriately)

and then:

ssh nova
cd supernova
svn info   #  see what version you're currently running
# Switch to the new version you just tagged
svn switch svn+ssh://astrometry.net/svn/tags/supernova/2011-06-08-2


When you're ready to tag 'nova', do:

svn copy svn+ssh://astrometry.net/svn/tags/supernova/2011-06-08-2 \
  svn+ssh://astrometry.net/svn/tags/nova/2011-06-08-1

and then:

ssh nova
cd nova
svn info   #  see what version you're currently running
# Switch to the new version you just tagged
svn switch svn+ssh://astrometry.net/svn/tags/nova/2011-06-08-2




Adding database users:

as root, psql:

create role USERNAME login;
alter role USERNAME createdb;
grant nova to USERNAME;


I did, initially:
create role nova;
alter role nova createdb;
grant all on database "an-test" to nova;
as nova:
create database "an-supernova";
create database "an-nova";
as root:
grant all on database "an-supernova" to nova;
grant all on database "an-nova" to nova;


