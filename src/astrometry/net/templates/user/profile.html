{% extends 'user/index.html' %}

{% block inline_css %}
{{block.super}}
{% include 'user_image/image_set.css' %}
{% include 'submission/list.css' %}
{% include 'job/status.css' %}
{% include 'dashboard/api_key.css' %}
<style type="text/css">
#profile_data {
    max-width: 675px;
    float:left;
}
</style>
{% endblock %}

{% block title %}
{{block.super}} &gt; 
{% include 'user/display_name.html' with user=display_user%}
{% endblock %}

{% block content %}
<div class="side_bar">
    <div>
        <h3>Account Info</h3>
        <div id="registered_on">registered on: <span class="timestamp">{{display_user.date_joined|date:"Y-m-d"}}</span></div>
        <div id="last_signin">last signed in: <span class="timestamp">{{display_user.last_login|date:"Y-m-d H:i"}}</span></div>
        {% if user.is_authenticated and user == display_user %}
        <br /><div>my API key: {% include 'user/api_key.html' with apikey=user.get_profile.apikey %}</div>
        {% endif %}
    </div>
    <hr />
    <div>
        <h3>Usage Stats</h3>
        <div id="submission_count">{{display_user.submissions.all.count}} submissions</div>
        <div id="image_count">{{display_user.user_images.all.count}} images</div>
        <div id="comment_count">{{display_user.comments_left.all.count}} comments</div>
    </div>
</div>
<div id="profile_data">
    <div id="profile_images">
        <h2>Recent Images</h2>
        {% if display_user.user_images.all %}  
        <a href="{% url astrometry.net.views.image.index_user user_id=display_user.id %}">View all</a>
        {% endif %}
        {% include 'user_image/image_set.html' with images=display_user.user_images.all|slice:":4" %}
    </div>
    <div id="profile_submissions">
        <h2>Recent Submissions</h2>
        {% include 'submission/list.html' with submissions=recent_submissions %}
    </div>
</div>
<div style="clear:both"></div>
{% endblock %}
