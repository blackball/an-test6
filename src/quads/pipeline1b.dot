graph P {
	graph [ rankdir = LR ];
	node [ shape=box ];
	edge [ dir=forward ];
	node [ style=filled, fillcolor=azure2 ];

	skdt [ label="Star kdtree\n(.skdt)" ];
	quad  [ label="Quad stars\n(.quad)" ];
	id    [ label="Star ID\n(.id)" ];
	ckdt  [ label="Code kdtree\n(.ckdt)" ];

	quad3  [ label="Quad stars (3)\n(.quad)" ];
	ckdt2  [ label="Code kdtree (2)\n(.ckdt)" ];
	skdt2 [ label="Star kdtree (2)\n(.skdt)" ];
	id2    [ label="Star ID (2)\n(.id)" ];

	node [ style=filled, fillcolor=lightyellow2 ];
	qidx [ label="Quad index\n(.qidx)" ];

	node [ style="" ];
	quad2  [ label="Quad stars (2)\n(.quad)" ];

	node [ shape=ellipse ];

	skdt -- unpermute_stars2 -- skdt2
	id   -- unpermute_stars2 -- id2
	quad -- unpermute_stars2 -- quad2

	quad2 -- unpermute_quads -- quad3
	ckdt  -- unpermute_quads -- ckdt2

	edge [ style=dashed ];
	quad3 -- quadidx -- qidx
}

// render with:
//   dot -Tps2 -o pipeline1b.eps pipeline1b.dot
//   epstopng pipeline1b.eps
